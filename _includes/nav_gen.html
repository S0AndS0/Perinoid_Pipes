{% comment %}
    # An amalgom of tips found at: https://thinkshout.com/blog/2014/12/creating-dynamic-menus-in-jekyll
    # and found at: http://stackoverflow.com/a/23504519/2632107
    # to provide a dynamicly generated preview of content about this project.
    # Liquid code value assignment simi-dynamic via includes inspired by
    # https://talk.jekyll.com/t/do-parameters-for-includes-allow-liquid-syntax/
    # Call this file with an includes command as shown bellow
    # ${% include preview_dir_pages.html preview_dir="_pages" preview_count=60 %}
    # Note calling with preview_count=0 will disable showing previews entirely
{% endcomment %}

{% assign default_directory_to_link = '_pages' %}
{% assign default_preview_word_count = '60' %}

{% assign preview_count_arg = include.preview_count %}
{% if preview_count_arg %}
  {% assign preview_count = preview_count_arg %}
{% else %}
  {% assign preview_count = default_preview_word_count %}
{% endif %}

{% assign preview_dir_arg = include.preview_dir %}
{% if preview_dir_arg %}
  {% assign preview_dir = preview_dir_arg %}
{% else %}
  {% assign preview_dir = default_directory_to_link %}
{% endif %}

{% comment %}
    # Move the endcomment line to bellow this one to show count and directory passed
{{preview_count}}
{{preview_dir}}
{% endcomment %}

<div class="container">
  <section id="nav_menu">
    <ul>
      {% for p in site.html_pages %}
        {% if p.title %}
          {% if p.url contains preview_dir %}
            {% if site.baseurl %}
              <h7><li><a href='{{site.baseurl}}{{p.url}}'{% if p.url == page.url %}class="active"{% endif %}>{{p.title}}</a></li></h7>
            {% else %}
              <h7><li><a href='{{p.url}}' {% if p.url == page.url %}class="active"{% endif %}>{{p.title}}</a></li></h7>
            {% endif %}

            {% if preview_count > 0 %}
              {{ p.content | strip_html | truncatewords: preview_count }}
            {% endif %}

          {% endif %}
        {% endif %}
      {% endfor %}
    </ul>
  </section>
</div>
